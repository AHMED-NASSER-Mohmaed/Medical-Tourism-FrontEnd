<div class="dashboard-container">
  <!-- Stats Cards -->
<div class="row g-4 mb-4">
  @for (stat of [
    { 
      title: 'Total Providers', 
      value: pagination.totalCount, 
      icon: icons.list, 
      color: currentViewConfig.color 
    },
    { 
      title: 'Approved', 
      value: approvedCount, 
      icon: icons.approve, 
      color: 'success' 
    },
    { 
      title: 'Pending', 
      value: pendingCount, 
      icon: icons.search, 
      color: 'warning' 
    },
    { 
      title: 'Under Review', 
      value: underReviewCount, 
      icon: icons.search, 
      color: 'primary' 
    }
  ]; track $index) {
    <div class="col-md-6 col-lg-3">
      <app-dashboard-card
        [title]="stat.title"
        [value]="stat.value"
        [icon]="stat.icon"
        [color]="getSafeColor(stat.color)">
      </app-dashboard-card>
    </div>
  }
</div>


  <!-- Main Card -->
  <div class="management-card">
    <!-- Card Header -->
    <div class="card-header">
      <div class="header-content">
        <div class="header-text">
          <h5>{{ currentViewConfig.label }} Management</h5>
          <p>Manage all {{ currentViewConfig.label.toLowerCase() }} providers in the system</p>
        </div>
        
        <div class="header-actions">
          <!-- Search Box -->
          <div class="search-box">
            <input type="text" 
                   class="search-input"
                   [(ngModel)]="searchTerm" 
                   (keyup.enter)="loadProviders()"
                   placeholder="Search {{ currentViewConfig.label.toLowerCase() }}...">
            <button class="search-button" (click)="loadProviders()">
              <fa-icon [icon]="icons.search"></fa-icon>
            </button>
          </div>

          <!-- View Toggle -->
          <div class="view-toggle">
            @for (view of viewConfigs; track view.type) {
              <button type="button"
                      class="view-button"
                      [class.active]="currentView === view.type"
                      (click)="changeView(view.type)">
                <fa-icon [icon]="view.icon" class="me-2"></fa-icon>
                {{ view.label }}
              </button>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Card Body -->
    <div class="card-body">
      @if (errorMessage) {
        <div class="error-alert">
          {{ errorMessage }}
        </div>
      }

      <!-- Providers Table -->
      <div class="table-responsive">
        <table class="providers-table">
          <thead>
            <tr>
              <th>Provider</th>
              <th>Type</th>
              <th>Status</th>
              <th>Registered</th>
              <th>Contact</th>
              <th class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            @if (isLoading) {
              <tr>
                <td colspan="6" class="loading-state">
                  <div class="spinner"></div>
                  <span>Loading providers...</span>
                </td>
              </tr>
            } @else {
              @for (provider of providers; track trackByProviderId($index, provider)) {
                <tr>
                  <td>
                    <div class="provider-info">
                      <div class="avatar-container">
                        <img [src]="provider.imageURL || 'assets/images/default-provider.png'"
                             alt="Provider logo"
                             class="provider-logo">
                        <span class="status-indicator"
                              [ngClass]="{
                                'approved': provider.verificationStatus === AssetStatus.APPROVED,
                                'pending': provider.verificationStatus === AssetStatus.PENDING,
                                'under-review': provider.verificationStatus === AssetStatus.UNDER_REVIEW
                              }"></span>
                      </div>
                      <div class="provider-details">
                        <div class="provider-name">{{ provider.assetName }}</div>
                        <div class="provider-meta">{{ provider.firstName }} {{ provider.lastName }}</div>
                      </div>
                    </div>
                  </td>
                  <td>
                    <span class="provider-type-badge">
                      {{ getProviderType(provider) }}
                    </span>
                  </td>
                  <td>
                    <app-status-badge
                      [statusValue]="provider.verificationStatus"
                      [statusIcon]="getStatusIcon(provider.verificationStatus)">
                    </app-status-badge>
                  </td>
                  <td>
                    {{ provider.acquisitionDate | date:'mediumDate' }}
                  </td>
                  <td>
                    <div class="contact-info">
                      <div>{{ provider.assetEmail }}</div>
                      <div>{{ provider.phone }}</div>
                    </div>
                  </td>
                  <td class="text-end">
                    <div class="action-buttons">
                      <button class="btn-action view" 
                              title="View details"
                              (click)="viewProviderDetails(provider.id)">
                        <fa-icon [icon]="icons.view"></fa-icon>
                      </button>
                      @if (provider.verificationStatus !== AssetStatus.APPROVED) {
                        <button class="btn-action approve" 
                                title="Approve"
                                (click)="changeProviderStatus(provider.id, true)"
                                [disabled]="isLoading">
                          <fa-icon [icon]="icons.approve"></fa-icon>
                        </button>
                      }
                      @if (provider.verificationStatus !== AssetStatus.PENDING) {
                        <button class="btn-action reject" 
                                title="Reject"
                                (click)="changeProviderStatus(provider.id, false)"
                                [disabled]="isLoading">
                          <fa-icon [icon]="icons.reject"></fa-icon>
                        </button>
                      }
                    </div>
                  </td>
                </tr>
              } @empty {
                <tr>
                  <td colspan="6" class="empty-state">
                    No providers found
                  </td>
                </tr>
              }
            }
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      @if (pagination.totalPages > 1) {
        <div class="pagination-container">
          <div class="pagination-info">
            {{ showingRange }}
          </div>
          
          <nav class="pagination-nav">
            <ul class="pagination">
              <li class="page-item" [class.disabled]="pagination.page === 1">
                <a class="page-link" (click)="onPageChange(pagination.page - 1)">
                  &laquo;
                </a>
              </li>
              
              @for (page of getPageNumbers(); track page) {
                <li class="page-item" 
                    [class.active]="page === pagination.page"
                    [class.disabled]="page === -1">
                  @if (page !== -1) {
                    <a class="page-link" (click)="onPageChange(page)">{{ page }}</a>
                  } @else {
                    <span class="page-link">...</span>
                  }
                </li>
              }
              
              <li class="page-item" [class.disabled]="pagination.page === pagination.totalPages">
                <a class="page-link" (click)="onPageChange(pagination.page + 1)">
                  &raquo;
                </a>
              </li>
            </ul>
          </nav>
        </div>
      }
    </div>
  </div>
</div>