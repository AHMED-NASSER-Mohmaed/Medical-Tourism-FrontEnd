<app-breadcrumb></app-breadcrumb>
<div *ngIf="room && !loading" class="profile-container">
  <!-- Left: Room Details -->
  <div class="profile-main-content">
    <div class="card room-details-card glassmorphism shadow-lg mb-4 animate__animated animate__zoomIn mt-4">
      <div class="row g-0 align-items-center">
        <div class="col-md-5 room-images position-relative">
          <div class="main-img-wrapper">
            <img *ngIf="room.roomImages && room.roomImages.length" [src]="selectedImage || room.roomImages[0].imageURL" class="img-fluid rounded main-room-img animate__animated animate__fadeIn" alt="Room Image">
            <img *ngIf="!room.roomImages || !room.roomImages.length" src="/assets/images/room1.jpg" class="img-fluid rounded main-room-img animate__animated animate__fadeIn" alt="Room Image">
          </div>
          <div class="room-thumbnails mt-3 d-flex flex-wrap justify-content-center" *ngIf="room.roomImages && room.roomImages.length > 1">
            <img *ngFor="let img of room.roomImages; let i = index" [src]="img.imageURL" class="img-thumbnail room-thumb animate__animated animate__fadeInUp" [class.active-thumb]="(selectedImage || room.roomImages[0].imageURL) === img.imageURL" (click)="selectImage(img.imageURL)" alt="Room Thumbnail">
          </div>
        </div>
        <div class="col-md-7">
          <div class="card-body animate__animated animate__fadeInRight">
            <div class="room-details-header animate__animated animate__fadeInDown mb-2">
              <div>
                <h2 class="room-title mb-1">Room {{ room.roomNumber }} - {{ roomTypeLabel(room.roomType) }}</h2>
                <div class="room-badges">
                  <span class="room-price-badge">${{ room.price }}</span>
                  <span class="availability-badge" [ngClass]="room.isAvailable ? 'available' : 'not-available'">
                    <i class="bi" [ngClass]="room.isAvailable ? 'bi-check-circle' : 'bi-x-circle'"></i>
                    {{ room.isAvailable ? 'Available' : 'Not Available' }}
                  </span>
                </div>
              </div>
            </div>
            <div class="room-sections animate__animated animate__fadeInUp">
              <div class="room-info-section">
                <div class="info-item"><i class="bi bi-people-fill"></i> <span>Max Occupancy:</span> <strong>{{ room.maxOccupancy }}</strong></div>
                <div class="info-item"><i class="bi bi-building"></i> <span>Floor:</span> <strong>{{ room.floorNumber }}</strong></div>
                <div class="info-item"><i class="bi bi-eye"></i> <span>View:</span> <strong>{{ viewTypeLabel(room.viewType) }}</strong></div>
                <div class="info-item"><i class="bi bi-info-circle"></i> <span>Status:</span> <strong>{{ roomStatusLabel(room.status) }}</strong></div>
                <div class="info-item" *ngIf="room.hasBalcony"><i class="bi bi-flower1"></i> Balcony</div>
                <div class="info-item" *ngIf="room.includesBreakfast"><i class="bi bi-egg-fried"></i> Breakfast Included</div>
              </div>
              <div class="hotel-info-section">
                <div class="info-item"><i class="bi bi-house"></i> <span>Hotel:</span> <strong>{{ room.hotelAssetName }}</strong></div>
                <div class="info-item" *ngIf="room.hotelStarRating"><i class="bi bi-star-fill text-warning"></i> <span>Rating:</span> <strong>{{ room.hotelStarRating }}</strong></div>
              </div>
            </div>
            <div class="room-description animate__animated animate__fadeInUp" *ngIf="room.description">
              <i class="bi bi-info-circle"></i>
              <span>{{ room.description }}</span>
            </div>
            <div class="room-amenities animate__animated animate__fadeInUp" *ngIf="room.amenities && room.amenities.length">
              <span class="amenity-badge animate__animated animate__pulse" *ngFor="let fac of room.amenities">
                <i class="bi bi-check-circle"></i> {{ fac }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Right: Sidebar for Booking -->
  <aside class="profile-sidebar">
    <div class="sidebar-card booking-card">
      <h3>BOOK THIS ROOM</h3>
      <form (ngSubmit)="bookRoom()" #bookingForm="ngForm">
        <div class="mb-3">
          <mat-form-field appearance="fill" class="custom-datepicker w-100">
            <mat-label>Check-in Date</mat-label>
            <input matInput
                   [matDatepicker]="checkInPicker"
                   [(ngModel)]="checkInDate"
                   [matDatepickerFilter]="dateFilter"
                   (dateChange)="showDateError = false"
                   placeholder="Choose a date"
                   name="checkInDate"
                   required
                   readonly
                   (click)="checkInPicker.open()">
            <mat-datepicker-toggle matSuffix [for]="checkInPicker"></mat-datepicker-toggle>
            <mat-datepicker #checkInPicker></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="mb-3">
          <mat-form-field appearance="fill" class="custom-datepicker w-100">
            <mat-label>Check-out Date</mat-label>
            <input matInput
                   [matDatepicker]="checkOutPicker"
                   [(ngModel)]="checkOutDate"
                   [matDatepickerFilter]="dateFilter"
                   (dateChange)="showDateError = false"
                   placeholder="Choose a date"
                   name="checkOutDate"
                   required
                   readonly
                   (click)="checkOutPicker.open()">
            <mat-datepicker-toggle matSuffix [for]="checkOutPicker"></mat-datepicker-toggle>
            <mat-datepicker #checkOutPicker></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="mb-2 text-muted" style="font-size: 0.95rem;">
          <i class="bi bi-info-circle"></i> Unavailable dates are grayed out and cannot be selected.
        </div>
        <div *ngIf="showDateError" class="validation-error mb-2">Please select both check-in and check-out dates.</div>
        <div *ngIf="bookingError" class="alert alert-danger mb-2">{{ bookingError }}</div>
        <div *ngIf="bookingSuccess" class="alert alert-success mb-2">{{ bookingSuccess }}</div>
        <button type="submit" class="btn btn-primary w-100" [disabled]="loading">Continue Booking</button>
      </form>
    </div>
  </aside>
</div>
<div *ngIf="error" class="alert alert-danger text-center animate__animated animate__fadeIn">
  {{ error }}
</div>

